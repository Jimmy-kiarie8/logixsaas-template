import{_ as pr}from"./FormComponent-85014e44.js";import{m as ro}from"./mapbox-gl-b26c6dbe.js";import{K as Kt,M as fr,N as on,k as K,o as hr,c as gr,w as Q,b as z,h as io,a as yr}from"./app-d02c39e6.js";/* empty css                       *//* empty css                  */import{_ as mr}from"./MainLayout-73462f0f.js";import{_ as vr}from"./_plugin-vue_export-helper-c27b6911.js";var ao={exports:{}};(function(F,we){(function(wt,ct){F.exports=ct()})(Kt,function(){var wt=function(t,e){var n={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},o={on:function(i,a,l){if(n[i]===void 0)throw new Error("Invalid event type: "+i);n[i].push({selector:a,fn:l})},render:function(i){e.store.featureChanged(i)}},r=function(i,a){for(var l=n[i],d=l.length;d--;){var h=l[d];if(h.selector(a)){h.fn.call(o,a)||e.store.render(),e.ui.updateMapClasses();break}}};return t.start.call(o),{render:t.render,stop:function(){t.stop&&t.stop()},trash:function(){t.trash&&(t.trash(),e.store.render())},combineFeatures:function(){t.combineFeatures&&t.combineFeatures()},uncombineFeatures:function(){t.uncombineFeatures&&t.uncombineFeatures()},drag:function(i){r("drag",i)},click:function(i){r("click",i)},mousemove:function(i){r("mousemove",i)},mousedown:function(i){r("mousedown",i)},mouseup:function(i){r("mouseup",i)},mouseout:function(i){r("mouseout",i)},keydown:function(i){r("keydown",i)},keyup:function(i){r("keyup",i)},touchstart:function(i){r("touchstart",i)},touchmove:function(i){r("touchmove",i)},touchend:function(i){r("touchend",i)},tap:function(i){r("tap",i)}}};function ct(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function rn(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function o(){if(this instanceof o){var r=[null];r.push.apply(r,arguments);var i=Function.bind.apply(e,r);return new i}return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(o){var r=Object.getOwnPropertyDescriptor(t,o);Object.defineProperty(n,o,r.get?r:{enumerable:!0,get:function(){return t[o]}})}),n}var Bt={},Ae={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:63567523142e-4},Qt=Ae;function te(t){var e=0;if(t&&t.length>0){e+=Math.abs(At(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(At(t[n]))}return e}function At(t){var e,n,o,r,i,a,l=0,d=t.length;if(d>2){for(a=0;a<d;a++)a===d-2?(o=d-2,r=d-1,i=0):a===d-1?(o=d-1,r=0,i=1):(o=a,r=a+1,i=a+2),e=t[o],n=t[r],l+=(Gt(t[i][0])-Gt(e[0]))*Math.sin(Gt(n[1]));l=l*Qt.RADIUS*Qt.RADIUS/2}return l}function Gt(t){return t*Math.PI/180}Bt.geometry=function t(e){var n,o=0;switch(e.type){case"Polygon":return te(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)o+=te(e.coordinates[n]);return o;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)o+=t(e.geometries[n]);return o}},Bt.ring=At;var $={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},Z={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},x={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},J={POLYGON:"polygon",LINE:"line_string",POINT:"point"},m={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},C={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},Y={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},Jt={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},V={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},B={ACTIVE:"true",INACTIVE:"false"},an=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],Fe=-85,so=Object.freeze({__proto__:null,classes:$,sources:Z,cursors:x,types:J,geojsonTypes:m,modes:C,events:Y,updateActions:Jt,meta:V,activeStates:B,interactions:an,LAT_MIN:-90,LAT_RENDERED_MIN:Fe,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),sn={Point:0,LineString:1,MultiLineString:1,Polygon:2};function uo(t,e){var n=sn[t.geometry.type]-sn[e.geometry.type];return n===0&&t.geometry.type===m.POLYGON?t.area-e.area:n}function un(t){return t.map(function(e){return e.geometry.type===m.POLYGON&&(e.area=Bt.geometry({type:m.FEATURE,property:{},geometry:e.geometry})),e}).sort(uo).map(function(e){return delete e.area,e})}function cn(t,e){return e===void 0&&(e=0),[[t.point.x-e,t.point.y-e],[t.point.x+e,t.point.y+e]]}function tt(t){if(this._items={},this._nums={},this._length=t?t.length:0,t)for(var e=0,n=t.length;e<n;e++)this.add(t[e]),t[e]!==void 0&&(typeof t[e]=="string"?this._items[t[e]]=e:this._nums[t[e]]=e)}tt.prototype.add=function(t){return this.has(t)||(this._length++,typeof t=="string"?this._items[t]=this._length:this._nums[t]=this._length),this},tt.prototype.delete=function(t){return this.has(t)===!1||(this._length--,delete this._items[t],delete this._nums[t]),this},tt.prototype.has=function(t){return(typeof t=="string"||typeof t=="number")&&(this._items[t]!==void 0||this._nums[t]!==void 0)},tt.prototype.values=function(){var t=this,e=[];return Object.keys(this._items).forEach(function(n){e.push({k:n,v:t._items[n]})}),Object.keys(this._nums).forEach(function(n){e.push({k:JSON.parse(n),v:t._nums[n]})}),e.sort(function(n,o){return n.v-o.v}).map(function(n){return n.k})},tt.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var co=[V.FEATURE,V.MIDPOINT,V.VERTEX],Ft={click:function(t,e,n){return ln(t,e,n,n.options.clickBuffer)},touch:function(t,e,n){return ln(t,e,n,n.options.touchBuffer)}};function ln(t,e,n,o){if(n.map===null)return[];var r=t?cn(t,o):e,i={};n.options.styles&&(i.layers=n.options.styles.map(function(h){return h.id}).filter(function(h){return n.map.getLayer(h)!=null}));var a=n.map.queryRenderedFeatures(r,i).filter(function(h){return co.indexOf(h.properties.meta)!==-1}),l=new tt,d=[];return a.forEach(function(h){var g=h.properties.id;l.has(g)||(l.add(g),d.push(h))}),un(d)}function ee(t,e){var n=Ft.click(t,null,e),o={mouse:x.NONE};return n[0]&&(o.mouse=n[0].properties.active===B.ACTIVE?x.MOVE:x.POINTER,o.feature=n[0].properties.meta),e.events.currentModeName().indexOf("draw")!==-1&&(o.mouse=x.ADD),e.ui.queueMapClasses(o),e.ui.updateMapClasses(),n[0]}function Pe(t,e){var n=t.x-e.x,o=t.y-e.y;return Math.sqrt(n*n+o*o)}function Re(t,e,n){n===void 0&&(n={});var o=n.fineTolerance!=null?n.fineTolerance:4,r=n.grossTolerance!=null?n.grossTolerance:12,i=n.interval!=null?n.interval:500;t.point=t.point||e.point,t.time=t.time||e.time;var a=Pe(t.point,e.point);return a<o||a<r&&e.time-t.time<i}function De(t,e,n){n===void 0&&(n={});var o=n.tolerance!=null?n.tolerance:25,r=n.interval!=null?n.interval:250;return t.point=t.point||e.point,t.time=t.time||e.time,Pe(t.point,e.point)<o&&e.time-t.time<r}var dn={exports:{}},ke=dn.exports=function(t,e){if(e||(e=16),t===void 0&&(t=128),t<=0)return"0";for(var n=Math.log(Math.pow(2,t))/Math.log(e),o=2;n===1/0;o*=2)n=Math.log(Math.pow(2,t/o))/Math.log(e)*o;var r=n-Math.floor(n),i="";for(o=0;o<Math.floor(n);o++)i=Math.floor(Math.random()*e).toString(e)+i;if(r){var a=Math.pow(e,r);i=Math.floor(Math.random()*a).toString(e)+i}var l=parseInt(i,e);return l!==1/0&&l>=Math.pow(2,t)?ke(t,e):i};ke.rack=function(t,e,n){var o=function(i){var a=0;do{if(a++>10){if(!n)throw new Error("too many ID collisions, use more bits");t+=n}var l=ke(t,e)}while(Object.hasOwnProperty.call(r,l));return r[l]=i,l},r=o.hats={};return o.get=function(i){return o.hats[i]},o.set=function(i,a){return o.hats[i]=a,o},o.bits=t||128,o.base=e||16,o};var Ue=ct(dn.exports),X=function(t,e){this.ctx=t,this.properties=e.properties||{},this.coordinates=e.geometry.coordinates,this.id=e.id||Ue(),this.type=e.geometry.type};X.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},X.prototype.incomingCoords=function(t){this.setCoordinates(t)},X.prototype.setCoordinates=function(t){this.coordinates=t,this.changed()},X.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},X.prototype.setProperty=function(t,e){this.properties[t]=e},X.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:m.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},X.prototype.internal=function(t){var e={id:this.id,meta:V.FEATURE,"meta:type":this.type,active:B.INACTIVE,mode:t};if(this.ctx.options.userProperties)for(var n in this.properties)e["user_"+n]=this.properties[n];return{type:m.FEATURE,properties:e,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var Ct=function(t,e){X.call(this,t,e)};(Ct.prototype=Object.create(X.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},Ct.prototype.updateCoordinate=function(t,e,n){this.coordinates=arguments.length===3?[e,n]:[t,e],this.changed()},Ct.prototype.getCoordinate=function(){return this.getCoordinates()};var lt=function(t,e){X.call(this,t,e)};(lt.prototype=Object.create(X.prototype)).isValid=function(){return this.coordinates.length>1},lt.prototype.addCoordinate=function(t,e,n){this.changed();var o=parseInt(t,10);this.coordinates.splice(o,0,[e,n])},lt.prototype.getCoordinate=function(t){var e=parseInt(t,10);return JSON.parse(JSON.stringify(this.coordinates[e]))},lt.prototype.removeCoordinate=function(t){this.changed(),this.coordinates.splice(parseInt(t,10),1)},lt.prototype.updateCoordinate=function(t,e,n){var o=parseInt(t,10);this.coordinates[o]=[e,n],this.changed()};var et=function(t,e){X.call(this,t,e),this.coordinates=this.coordinates.map(function(n){return n.slice(0,-1)})};(et.prototype=Object.create(X.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every(function(t){return t.length>2})},et.prototype.incomingCoords=function(t){this.coordinates=t.map(function(e){return e.slice(0,-1)}),this.changed()},et.prototype.setCoordinates=function(t){this.coordinates=t,this.changed()},et.prototype.addCoordinate=function(t,e,n){this.changed();var o=t.split(".").map(function(r){return parseInt(r,10)});this.coordinates[o[0]].splice(o[1],0,[e,n])},et.prototype.removeCoordinate=function(t){this.changed();var e=t.split(".").map(function(o){return parseInt(o,10)}),n=this.coordinates[e[0]];n&&(n.splice(e[1],1),n.length<3&&this.coordinates.splice(e[0],1))},et.prototype.getCoordinate=function(t){var e=t.split(".").map(function(o){return parseInt(o,10)}),n=this.coordinates[e[0]];return JSON.parse(JSON.stringify(n[e[1]]))},et.prototype.getCoordinates=function(){return this.coordinates.map(function(t){return t.concat([t[0]])})},et.prototype.updateCoordinate=function(t,e,n){this.changed();var o=t.split("."),r=parseInt(o[0],10),i=parseInt(o[1],10);this.coordinates[r]===void 0&&(this.coordinates[r]=[]),this.coordinates[r][i]=[e,n]};var lo={MultiPoint:Ct,MultiLineString:lt,MultiPolygon:et},ne=function(t,e,n,o,r){var i=n.split("."),a=parseInt(i[0],10),l=i[1]?i.slice(1).join("."):null;return t[a][e](l,o,r)},W=function(t,e){if(X.call(this,t,e),delete this.coordinates,this.model=lo[e.geometry.type],this.model===void 0)throw new TypeError(e.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(e.geometry.coordinates)};function E(t){this.map=t.map,this.drawConfig=JSON.parse(JSON.stringify(t.options||{})),this._ctx=t}(W.prototype=Object.create(X.prototype))._coordinatesToFeatures=function(t){var e=this,n=this.model.bind(this);return t.map(function(o){return new n(e.ctx,{id:Ue(),type:m.FEATURE,properties:{},geometry:{coordinates:o,type:e.type.replace("Multi","")}})})},W.prototype.isValid=function(){return this.features.every(function(t){return t.isValid()})},W.prototype.setCoordinates=function(t){this.features=this._coordinatesToFeatures(t),this.changed()},W.prototype.getCoordinate=function(t){return ne(this.features,"getCoordinate",t)},W.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(t){return t.type===m.POLYGON?t.getCoordinates():t.coordinates})))},W.prototype.updateCoordinate=function(t,e,n){ne(this.features,"updateCoordinate",t,e,n),this.changed()},W.prototype.addCoordinate=function(t,e,n){ne(this.features,"addCoordinate",t,e,n),this.changed()},W.prototype.removeCoordinate=function(t){ne(this.features,"removeCoordinate",t),this.changed()},W.prototype.getFeatures=function(){return this.features},E.prototype.setSelected=function(t){return this._ctx.store.setSelected(t)},E.prototype.setSelectedCoordinates=function(t){var e=this;this._ctx.store.setSelectedCoordinates(t),t.reduce(function(n,o){return n[o.feature_id]===void 0&&(n[o.feature_id]=!0,e._ctx.store.get(o.feature_id).changed()),n},{})},E.prototype.getSelected=function(){return this._ctx.store.getSelected()},E.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},E.prototype.isSelected=function(t){return this._ctx.store.isSelected(t)},E.prototype.getFeature=function(t){return this._ctx.store.get(t)},E.prototype.select=function(t){return this._ctx.store.select(t)},E.prototype.deselect=function(t){return this._ctx.store.deselect(t)},E.prototype.deleteFeature=function(t,e){return e===void 0&&(e={}),this._ctx.store.delete(t,e)},E.prototype.addFeature=function(t){return this._ctx.store.add(t)},E.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},E.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},E.prototype.setActionableState=function(t){t===void 0&&(t={});var e={trash:t.trash||!1,combineFeatures:t.combineFeatures||!1,uncombineFeatures:t.uncombineFeatures||!1};return this._ctx.events.actionable(e)},E.prototype.changeMode=function(t,e,n){return e===void 0&&(e={}),n===void 0&&(n={}),this._ctx.events.changeMode(t,e,n)},E.prototype.updateUIClasses=function(t){return this._ctx.ui.queueMapClasses(t)},E.prototype.activateUIButton=function(t){return this._ctx.ui.setActiveButton(t)},E.prototype.featuresAt=function(t,e,n){if(n===void 0&&(n="click"),n!=="click"&&n!=="touch")throw new Error("invalid buffer type");return Ft[n](t,e,this._ctx)},E.prototype.newFeature=function(t){var e=t.geometry.type;return e===m.POINT?new Ct(this._ctx,t):e===m.LINE_STRING?new lt(this._ctx,t):e===m.POLYGON?new et(this._ctx,t):new W(this._ctx,t)},E.prototype.isInstanceOf=function(t,e){if(t===m.POINT)return e instanceof Ct;if(t===m.LINE_STRING)return e instanceof lt;if(t===m.POLYGON)return e instanceof et;if(t==="MultiFeature")return e instanceof W;throw new Error("Unknown feature class: "+t)},E.prototype.doRender=function(t){return this._ctx.store.featureChanged(t)},E.prototype.onSetup=function(){},E.prototype.onDrag=function(){},E.prototype.onClick=function(){},E.prototype.onMouseMove=function(){},E.prototype.onMouseDown=function(){},E.prototype.onMouseUp=function(){},E.prototype.onMouseOut=function(){},E.prototype.onKeyUp=function(){},E.prototype.onKeyDown=function(){},E.prototype.onTouchStart=function(){},E.prototype.onTouchMove=function(){},E.prototype.onTouchEnd=function(){},E.prototype.onTap=function(){},E.prototype.onStop=function(){},E.prototype.onTrash=function(){},E.prototype.onCombineFeature=function(){},E.prototype.onUncombineFeature=function(){},E.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var pn={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},po=Object.keys(pn);function fo(t){var e=Object.keys(t);return function(n,o){o===void 0&&(o={});var r={},i=e.reduce(function(a,l){return a[l]=t[l],a},new E(n));return{start:function(){var a=this;r=i.onSetup(o),po.forEach(function(l){var d,h=pn[l],g=function(){return!1};t[h]&&(g=function(){return!0}),a.on(l,g,(d=h,function(p){return i[d](r,p)}))})},stop:function(){i.onStop(r)},trash:function(){i.onTrash(r)},combineFeatures:function(){i.onCombineFeatures(r)},uncombineFeatures:function(){i.onUncombineFeatures(r)},render:function(a,l){i.toDisplayFeatures(r,a,l)}}}}function zt(t){return[].concat(t).filter(function(e){return e!==void 0})}function ho(){var t=this;if(!(t.ctx.map&&t.ctx.map.getSource(Z.HOT)!==void 0))return d();var e=t.ctx.events.currentModeName();t.ctx.ui.queueMapClasses({mode:e});var n=[],o=[];t.isDirty?o=t.getAllIds():(n=t.getChangedIds().filter(function(h){return t.get(h)!==void 0}),o=t.sources.hot.filter(function(h){return h.properties.id&&n.indexOf(h.properties.id)===-1&&t.get(h.properties.id)!==void 0}).map(function(h){return h.properties.id})),t.sources.hot=[];var r=t.sources.cold.length;t.sources.cold=t.isDirty?[]:t.sources.cold.filter(function(h){var g=h.properties.id||h.properties.parent;return n.indexOf(g)===-1});var i=r!==t.sources.cold.length||o.length>0;function a(h,g){var p=t.get(h).internal(e);t.ctx.events.currentModeRender(p,function(_){t.sources[g].push(_)})}if(n.forEach(function(h){return a(h,"hot")}),o.forEach(function(h){return a(h,"cold")}),i&&t.ctx.map.getSource(Z.COLD).setData({type:m.FEATURE_COLLECTION,features:t.sources.cold}),t.ctx.map.getSource(Z.HOT).setData({type:m.FEATURE_COLLECTION,features:t.sources.hot}),t._emitSelectionChange&&(t.ctx.map.fire(Y.SELECTION_CHANGE,{features:t.getSelected().map(function(h){return h.toGeoJSON()}),points:t.getSelectedCoordinates().map(function(h){return{type:m.FEATURE,properties:{},geometry:{type:m.POINT,coordinates:h.coordinates}}})}),t._emitSelectionChange=!1),t._deletedFeaturesToEmit.length){var l=t._deletedFeaturesToEmit.map(function(h){return h.toGeoJSON()});t._deletedFeaturesToEmit=[],t.ctx.map.fire(Y.DELETE,{features:l})}function d(){t.isDirty=!1,t.clearChangedIds()}d(),t.ctx.map.fire(Y.RENDER,{})}function M(t){var e,n=this;this._features={},this._featureIds=new tt,this._selectedFeatureIds=new tt,this._selectedCoordinates=[],this._changedFeatureIds=new tt,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=t,this.sources={hot:[],cold:[]},this.render=function(){e||(e=requestAnimationFrame(function(){e=null,ho.call(n)}))},this.isDirty=!1}function fn(t,e){var n=t._selectedCoordinates.filter(function(o){return t._selectedFeatureIds.has(o.feature_id)});t._selectedCoordinates.length===n.length||e.silent||(t._emitSelectionChange=!0),t._selectedCoordinates=n}M.prototype.createRenderBatch=function(){var t=this,e=this.render,n=0;return this.render=function(){n++},function(){t.render=e,n>0&&t.render()}},M.prototype.setDirty=function(){return this.isDirty=!0,this},M.prototype.featureChanged=function(t){return this._changedFeatureIds.add(t),this},M.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},M.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},M.prototype.getAllIds=function(){return this._featureIds.values()},M.prototype.add=function(t){return this.featureChanged(t.id),this._features[t.id]=t,this._featureIds.add(t.id),this},M.prototype.delete=function(t,e){var n=this;return e===void 0&&(e={}),zt(t).forEach(function(o){n._featureIds.has(o)&&(n._featureIds.delete(o),n._selectedFeatureIds.delete(o),e.silent||n._deletedFeaturesToEmit.indexOf(n._features[o])===-1&&n._deletedFeaturesToEmit.push(n._features[o]),delete n._features[o],n.isDirty=!0)}),fn(this,e),this},M.prototype.get=function(t){return this._features[t]},M.prototype.getAll=function(){var t=this;return Object.keys(this._features).map(function(e){return t._features[e]})},M.prototype.select=function(t,e){var n=this;return e===void 0&&(e={}),zt(t).forEach(function(o){n._selectedFeatureIds.has(o)||(n._selectedFeatureIds.add(o),n._changedFeatureIds.add(o),e.silent||(n._emitSelectionChange=!0))}),this},M.prototype.deselect=function(t,e){var n=this;return e===void 0&&(e={}),zt(t).forEach(function(o){n._selectedFeatureIds.has(o)&&(n._selectedFeatureIds.delete(o),n._changedFeatureIds.add(o),e.silent||(n._emitSelectionChange=!0))}),fn(this,e),this},M.prototype.clearSelected=function(t){return t===void 0&&(t={}),this.deselect(this._selectedFeatureIds.values(),{silent:t.silent}),this},M.prototype.setSelected=function(t,e){var n=this;return e===void 0&&(e={}),t=zt(t),this.deselect(this._selectedFeatureIds.values().filter(function(o){return t.indexOf(o)===-1}),{silent:e.silent}),this.select(t.filter(function(o){return!n._selectedFeatureIds.has(o)}),{silent:e.silent}),this},M.prototype.setSelectedCoordinates=function(t){return this._selectedCoordinates=t,this._emitSelectionChange=!0,this},M.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},M.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},M.prototype.getSelected=function(){var t=this;return this._selectedFeatureIds.values().map(function(e){return t.get(e)})},M.prototype.getSelectedCoordinates=function(){var t=this;return this._selectedCoordinates.map(function(e){return{coordinates:t.get(e.feature_id).getCoordinate(e.coord_path)}})},M.prototype.isSelected=function(t){return this._selectedFeatureIds.has(t)},M.prototype.setFeatureProperty=function(t,e,n){this.get(t).setProperty(e,n),this.featureChanged(t)},M.prototype.storeMapConfig=function(){var t=this;an.forEach(function(e){t.ctx.map[e]&&(t._mapInitialConfig[e]=t.ctx.map[e].isEnabled())})},M.prototype.restoreMapConfig=function(){var t=this;Object.keys(this._mapInitialConfig).forEach(function(e){t._mapInitialConfig[e]?t.ctx.map[e].enable():t.ctx.map[e].disable()})},M.prototype.getInitialConfigValue=function(t){return this._mapInitialConfig[t]===void 0||this._mapInitialConfig[t]};var go=function(){for(var t=arguments,e={},n=0;n<arguments.length;n++){var o=t[n];for(var r in o)yo.call(o,r)&&(e[r]=o[r])}return e},yo=Object.prototype.hasOwnProperty,yt=ct(go),mo=["mode","feature","mouse"];function vo(t){var e=null,n=null,o={onRemove:function(){return t.map.off("load",o.connect),clearInterval(n),o.removeLayers(),t.store.restoreMapConfig(),t.ui.removeButtons(),t.events.removeEventListeners(),t.ui.clearMapClasses(),t.boxZoomInitial&&t.map.boxZoom.enable(),t.map=null,t.container=null,t.store=null,e&&e.parentNode&&e.parentNode.removeChild(e),e=null,this},connect:function(){t.map.off("load",o.connect),clearInterval(n),o.addLayers(),t.store.storeMapConfig(),t.events.addEventListeners()},onAdd:function(r){var i=r.fire;return r.fire=function(a,l){var d=arguments;return i.length===1&&arguments.length!==1&&(d=[yt({},{type:a},l)]),i.apply(r,d)},t.map=r,t.events=function(a){var l=Object.keys(a.options.modes).reduce(function(c,y){return c[y]=fo(a.options.modes[y]),c},{}),d={},h={},g={},p=null,_=null;g.drag=function(c,y){y({point:c.point,time:new Date().getTime()})?(a.ui.queueMapClasses({mouse:x.DRAG}),_.drag(c)):c.originalEvent.stopPropagation()},g.mousedrag=function(c){g.drag(c,function(y){return!Re(d,y)})},g.touchdrag=function(c){g.drag(c,function(y){return!De(h,y)})},g.mousemove=function(c){if((c.originalEvent.buttons!==void 0?c.originalEvent.buttons:c.originalEvent.which)===1)return g.mousedrag(c);var y=ee(c,a);c.featureTarget=y,_.mousemove(c)},g.mousedown=function(c){d={time:new Date().getTime(),point:c.point};var y=ee(c,a);c.featureTarget=y,_.mousedown(c)},g.mouseup=function(c){var y=ee(c,a);c.featureTarget=y,Re(d,{point:c.point,time:new Date().getTime()})?_.click(c):_.mouseup(c)},g.mouseout=function(c){_.mouseout(c)},g.touchstart=function(c){if(a.options.touchEnabled){h={time:new Date().getTime(),point:c.point};var y=Ft.touch(c,null,a)[0];c.featureTarget=y,_.touchstart(c)}},g.touchmove=function(c){if(a.options.touchEnabled)return _.touchmove(c),g.touchdrag(c)},g.touchend=function(c){if(c.originalEvent.preventDefault(),a.options.touchEnabled){var y=Ft.touch(c,null,a)[0];c.featureTarget=y,De(h,{time:new Date().getTime(),point:c.point})?_.tap(c):_.touchend(c)}};var w=function(c){return!(c===8||c===46||c>=48&&c<=57)};function b(c,y,S){S===void 0&&(S={}),_.stop();var G=l[c];if(G===void 0)throw new Error(c+" is not valid");p=c;var R=G(a,y);_=wt(R,a),S.silent||a.map.fire(Y.MODE_CHANGE,{mode:c}),a.store.setDirty(),a.store.render()}g.keydown=function(c){(c.srcElement||c.target).classList.contains("mapboxgl-canvas")&&(c.keyCode!==8&&c.keyCode!==46||!a.options.controls.trash?w(c.keyCode)?_.keydown(c):c.keyCode===49&&a.options.controls.point?b(C.DRAW_POINT):c.keyCode===50&&a.options.controls.line_string?b(C.DRAW_LINE_STRING):c.keyCode===51&&a.options.controls.polygon&&b(C.DRAW_POLYGON):(c.preventDefault(),_.trash()))},g.keyup=function(c){w(c.keyCode)&&_.keyup(c)},g.zoomend=function(){a.store.changeZoom()},g.data=function(c){if(c.dataType==="style"){var y=a.setup,S=a.map,G=a.options,R=a.store;G.styles.some(function(Ye){return S.getLayer(Ye.id)})||(y.addLayers(),R.setDirty(),R.render())}};var P={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){p=a.options.defaultMode,_=wt(l[p](a),a)},changeMode:b,actionable:function(c){var y=!1;Object.keys(c).forEach(function(S){if(P[S]===void 0)throw new Error("Invalid action type");P[S]!==c[S]&&(y=!0),P[S]=c[S]}),y&&a.map.fire(Y.ACTIONABLE,{actions:P})},currentModeName:function(){return p},currentModeRender:function(c,y){return _.render(c,y)},fire:function(c,y){g[c]&&g[c](y)},addEventListeners:function(){a.map.on("mousemove",g.mousemove),a.map.on("mousedown",g.mousedown),a.map.on("mouseup",g.mouseup),a.map.on("data",g.data),a.map.on("touchmove",g.touchmove),a.map.on("touchstart",g.touchstart),a.map.on("touchend",g.touchend),a.container.addEventListener("mouseout",g.mouseout),a.options.keybindings&&(a.container.addEventListener("keydown",g.keydown),a.container.addEventListener("keyup",g.keyup))},removeEventListeners:function(){a.map.off("mousemove",g.mousemove),a.map.off("mousedown",g.mousedown),a.map.off("mouseup",g.mouseup),a.map.off("data",g.data),a.map.off("touchmove",g.touchmove),a.map.off("touchstart",g.touchstart),a.map.off("touchend",g.touchend),a.container.removeEventListener("mouseout",g.mouseout),a.options.keybindings&&(a.container.removeEventListener("keydown",g.keydown),a.container.removeEventListener("keyup",g.keyup))},trash:function(c){_.trash(c)},combineFeatures:function(){_.combineFeatures()},uncombineFeatures:function(){_.uncombineFeatures()},getMode:function(){return p}}}(t),t.ui=function(a){var l={},d=null,h={mode:null,feature:null,mouse:null},g={mode:null,feature:null,mouse:null};function p(c){g=yt(g,c)}function _(){var c,y;if(a.container){var S=[],G=[];mo.forEach(function(R){g[R]!==h[R]&&(S.push(R+"-"+h[R]),g[R]!==null&&G.push(R+"-"+g[R]))}),S.length>0&&(c=a.container.classList).remove.apply(c,S),G.length>0&&(y=a.container.classList).add.apply(y,G),h=yt(h,g)}}function w(c,y){y===void 0&&(y={});var S=document.createElement("button");return S.className=$.CONTROL_BUTTON+" "+y.className,S.setAttribute("title",y.title),y.container.appendChild(S),S.addEventListener("click",function(G){if(G.preventDefault(),G.stopPropagation(),G.target===d)return b(),void y.onDeactivate();P(c),y.onActivate()},!0),S}function b(){d&&(d.classList.remove($.ACTIVE_BUTTON),d=null)}function P(c){b();var y=l[c];y&&y&&c!=="trash"&&(y.classList.add($.ACTIVE_BUTTON),d=y)}return{setActiveButton:P,queueMapClasses:p,updateMapClasses:_,clearMapClasses:function(){p({mode:null,feature:null,mouse:null}),_()},addButtons:function(){var c=a.options.controls,y=document.createElement("div");return y.className=$.CONTROL_GROUP+" "+$.CONTROL_BASE,c&&(c[J.LINE]&&(l[J.LINE]=w(J.LINE,{container:y,className:$.CONTROL_BUTTON_LINE,title:"LineString tool "+(a.options.keybindings?"(l)":""),onActivate:function(){return a.events.changeMode(C.DRAW_LINE_STRING)},onDeactivate:function(){return a.events.trash()}})),c[J.POLYGON]&&(l[J.POLYGON]=w(J.POLYGON,{container:y,className:$.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(a.options.keybindings?"(p)":""),onActivate:function(){return a.events.changeMode(C.DRAW_POLYGON)},onDeactivate:function(){return a.events.trash()}})),c[J.POINT]&&(l[J.POINT]=w(J.POINT,{container:y,className:$.CONTROL_BUTTON_POINT,title:"Marker tool "+(a.options.keybindings?"(m)":""),onActivate:function(){return a.events.changeMode(C.DRAW_POINT)},onDeactivate:function(){return a.events.trash()}})),c.trash&&(l.trash=w("trash",{container:y,className:$.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){a.events.trash()}})),c.combine_features&&(l.combine_features=w("combineFeatures",{container:y,className:$.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){a.events.combineFeatures()}})),c.uncombine_features&&(l.uncombine_features=w("uncombineFeatures",{container:y,className:$.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){a.events.uncombineFeatures()}}))),y},removeButtons:function(){Object.keys(l).forEach(function(c){var y=l[c];y.parentNode&&y.parentNode.removeChild(y),delete l[c]})}}}(t),t.container=r.getContainer(),t.store=new M(t),e=t.ui.addButtons(),t.options.boxSelect&&(t.boxZoomInitial=r.boxZoom.isEnabled(),r.boxZoom.disable(),r.dragPan.disable(),r.dragPan.enable()),r.loaded()?o.connect():(r.on("load",o.connect),n=setInterval(function(){r.loaded()&&o.connect()},16)),t.events.start(),e},addLayers:function(){t.map.addSource(Z.COLD,{data:{type:m.FEATURE_COLLECTION,features:[]},type:"geojson"}),t.map.addSource(Z.HOT,{data:{type:m.FEATURE_COLLECTION,features:[]},type:"geojson"}),t.options.styles.forEach(function(r){t.map.addLayer(r)}),t.store.setDirty(!0),t.store.render()},removeLayers:function(){t.options.styles.forEach(function(r){t.map.getLayer(r.id)&&t.map.removeLayer(r.id)}),t.map.getSource(Z.COLD)&&t.map.removeSource(Z.COLD),t.map.getSource(Z.HOT)&&t.map.removeSource(Z.HOT)}};return t.setup=o,o}var hn=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function oe(t){return function(e){var n=e.featureTarget;return!!n&&!!n.properties&&n.properties.meta===t}}function gn(t){return!!t.originalEvent&&!!t.originalEvent.shiftKey&&t.originalEvent.button===0}function Tt(t){return!!t.featureTarget&&!!t.featureTarget.properties&&t.featureTarget.properties.active===B.ACTIVE&&t.featureTarget.properties.meta===V.FEATURE}function je(t){return!!t.featureTarget&&!!t.featureTarget.properties&&t.featureTarget.properties.active===B.INACTIVE&&t.featureTarget.properties.meta===V.FEATURE}function re(t){return t.featureTarget===void 0}function Ve(t){return!!t.featureTarget&&!!t.featureTarget.properties&&t.featureTarget.properties.meta===V.FEATURE}function $t(t){var e=t.featureTarget;return!!e&&!!e.properties&&e.properties.meta===V.VERTEX}function ie(t){return!!t.originalEvent&&t.originalEvent.shiftKey===!0}function ae(t){return t.keyCode===27}function se(t){return t.keyCode===13}var _o=Object.freeze({__proto__:null,isOfMetaType:oe,isShiftMousedown:gn,isActiveFeature:Tt,isInactiveFeature:je,noTarget:re,isFeature:Ve,isVertex:$t,isShiftDown:ie,isEscapeKey:ae,isEnterKey:se,isTrue:function(){return!0}}),bo=Pt;function Pt(t,e){this.x=t,this.y=e}Pt.prototype={clone:function(){return new Pt(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),o=e*this.x-n*this.y,r=n*this.x+e*this.y;return this.x=o,this.y=r,this},_rotateAround:function(t,e){var n=Math.cos(t),o=Math.sin(t),r=e.x+n*(this.x-e.x)-o*(this.y-e.y),i=e.y+o*(this.x-e.x)+n*(this.y-e.y);return this.x=r,this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Pt.convert=function(t){return t instanceof Pt?t:Array.isArray(t)?new Pt(t[0],t[1]):t};var Eo=ct(bo);function Be(t,e){var n=e.getBoundingClientRect();return new Eo(t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0))}function Rt(t,e,n,o){return{type:m.FEATURE,properties:{meta:V.VERTEX,parent:t,coord_path:n,active:o?B.ACTIVE:B.INACTIVE},geometry:{type:m.POINT,coordinates:e}}}function yn(t,e,n){var o=e.geometry.coordinates,r=n.geometry.coordinates;if(o[1]>85||o[1]<Fe||r[1]>85||r[1]<Fe)return null;var i={lng:(o[0]+r[0])/2,lat:(o[1]+r[1])/2};return{type:m.FEATURE,properties:{meta:V.MIDPOINT,parent:t,lng:i.lng,lat:i.lat,coord_path:n.properties.coord_path},geometry:{type:m.POINT,coordinates:[i.lng,i.lat]}}}function ue(t,e,n){e===void 0&&(e={}),n===void 0&&(n=null);var o,r=t.geometry,i=r.type,a=r.coordinates,l=t.properties&&t.properties.id,d=[];function h(p,_){var w="",b=null;p.forEach(function(P,c){var y=_!=null?_+"."+c:String(c),S=Rt(l,P,y,g(y));if(e.midpoints&&b){var G=yn(l,b,S);G&&d.push(G)}b=S;var R=JSON.stringify(P);w!==R&&d.push(S),c===0&&(w=R)})}function g(p){return!!e.selectedPaths&&e.selectedPaths.indexOf(p)!==-1}return i===m.POINT?d.push(Rt(l,a,n,g(n))):i===m.POLYGON?a.forEach(function(p,_){h(p,n!==null?n+"."+_:String(_))}):i===m.LINE_STRING?h(a,n):i.indexOf(m.MULTI_PREFIX)===0&&(o=i.replace(m.MULTI_PREFIX,""),a.forEach(function(p,_){var w={type:m.FEATURE,properties:t.properties,geometry:{type:o,coordinates:p}};d=d.concat(ue(w,e,_))})),d}var rt={enable:function(t){setTimeout(function(){t.map&&t.map.doubleClickZoom&&t._ctx&&t._ctx.store&&t._ctx.store.getInitialConfigValue&&t._ctx.store.getInitialConfigValue("doubleClickZoom")&&t.map.doubleClickZoom.enable()},0)},disable:function(t){setTimeout(function(){t.map&&t.map.doubleClickZoom&&t.map.doubleClickZoom.disable()},0)}},ce={exports:{}},mn=function(t){if(!t||!t.type)return null;var e=Co[t.type];if(!e)return null;if(e==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]};if(e==="feature")return{type:"FeatureCollection",features:[t]};if(e==="featurecollection")return t},Co={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},To=ct(mn),So=Object.freeze({__proto__:null,default:function t(e){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.reduce(function(n,o){return n.concat(t(o))},[]),e;case"Feature":return e.geometry?t(e.geometry).map(function(n){var o={type:"Feature",properties:JSON.parse(JSON.stringify(e.properties)),geometry:n};return e.id!==void 0&&(o.id=e.id),o}):[e];case"MultiPoint":return e.coordinates.map(function(n){return{type:"Point",coordinates:n}});case"MultiPolygon":return e.coordinates.map(function(n){return{type:"Polygon",coordinates:n}});case"MultiLineString":return e.coordinates.map(function(n){return{type:"LineString",coordinates:n}});case"GeometryCollection":return e.geometries.map(t).reduce(function(n,o){return n.concat(o)},[]);case"Point":case"Polygon":case"LineString":return[e]}}}),Oo=mn,le=rn(So),Io=function(t){return function e(n){return Array.isArray(n)&&n.length&&typeof n[0]=="number"?[n]:n.reduce(function(o,r){return Array.isArray(r)&&Array.isArray(r[0])?o.concat(e(r)):(o.push(r),o)},[])}(t)};le instanceof Function||(le=le.default);var vn={exports:{}},xo=vn.exports=function(t){return new nt(t)};function nt(t){this.value=t}function _n(t,e,n){var o=[],r=[],i=!0;return function a(l){var d=n?bn(l):l,h={},g=!0,p={node:d,node_:l,path:[].concat(o),parent:r[r.length-1],parents:r,key:o.slice(-1)[0],isRoot:o.length===0,level:o.length,circular:null,update:function(b,P){p.isRoot||(p.parent.node[p.key]=b),p.node=b,P&&(g=!1)},delete:function(b){delete p.parent.node[p.key],b&&(g=!1)},remove:function(b){En(p.parent.node)?p.parent.node.splice(p.key,1):delete p.parent.node[p.key],b&&(g=!1)},keys:null,before:function(b){h.before=b},after:function(b){h.after=b},pre:function(b){h.pre=b},post:function(b){h.post=b},stop:function(){i=!1},block:function(){g=!1}};if(!i)return p;function _(){if(typeof p.node=="object"&&p.node!==null){p.keys&&p.node_===p.node||(p.keys=de(p.node)),p.isLeaf=p.keys.length==0;for(var b=0;b<r.length;b++)if(r[b].node_===l){p.circular=r[b];break}}else p.isLeaf=!0,p.keys=null;p.notLeaf=!p.isLeaf,p.notRoot=!p.isRoot}_();var w=e.call(p,p.node);return w!==void 0&&p.update&&p.update(w),h.before&&h.before.call(p,p.node),g&&(typeof p.node!="object"||p.node===null||p.circular||(r.push(p),_(),pe(p.keys,function(b,P){o.push(b),h.pre&&h.pre.call(p,p.node[b],b);var c=a(p.node[b]);n&&fe.call(p.node,b)&&(p.node[b]=c.node),c.isLast=P==p.keys.length-1,c.isFirst=P==0,h.post&&h.post.call(p,c),o.pop()}),r.pop()),h.after&&h.after.call(p,p.node)),p}(t).node}function bn(t){if(typeof t=="object"&&t!==null){var e;if(En(t))e=[];else if(Dt(t)==="[object Date]")e=new Date(t.getTime?t.getTime():t);else if(function(r){return Dt(r)==="[object RegExp]"}(t))e=new RegExp(t);else if(function(r){return Dt(r)==="[object Error]"}(t))e={message:t.message};else if(function(r){return Dt(r)==="[object Boolean]"}(t))e=new Boolean(t);else if(function(r){return Dt(r)==="[object Number]"}(t))e=new Number(t);else if(function(r){return Dt(r)==="[object String]"}(t))e=new String(t);else if(Object.create&&Object.getPrototypeOf)e=Object.create(Object.getPrototypeOf(t));else if(t.constructor===Object)e={};else{var n=t.constructor&&t.constructor.prototype||t.__proto__||{},o=function(){};o.prototype=n,e=new o}return pe(de(t),function(r){e[r]=t[r]}),e}return t}nt.prototype.get=function(t){for(var e=this.value,n=0;n<t.length;n++){var o=t[n];if(!e||!fe.call(e,o)){e=void 0;break}e=e[o]}return e},nt.prototype.has=function(t){for(var e=this.value,n=0;n<t.length;n++){var o=t[n];if(!e||!fe.call(e,o))return!1;e=e[o]}return!0},nt.prototype.set=function(t,e){for(var n=this.value,o=0;o<t.length-1;o++){var r=t[o];fe.call(n,r)||(n[r]={}),n=n[r]}return n[t[o]]=e,e},nt.prototype.map=function(t){return _n(this.value,t,!0)},nt.prototype.forEach=function(t){return this.value=_n(this.value,t,!1),this.value},nt.prototype.reduce=function(t,e){var n=arguments.length===1,o=n?this.value:e;return this.forEach(function(r){this.isRoot&&n||(o=t.call(this,o,r))}),o},nt.prototype.paths=function(){var t=[];return this.forEach(function(e){t.push(this.path)}),t},nt.prototype.nodes=function(){var t=[];return this.forEach(function(e){t.push(this.node)}),t},nt.prototype.clone=function(){var t=[],e=[];return function n(o){for(var r=0;r<t.length;r++)if(t[r]===o)return e[r];if(typeof o=="object"&&o!==null){var i=bn(o);return t.push(o),e.push(i),pe(de(o),function(a){i[a]=n(o[a])}),t.pop(),e.pop(),i}return o}(this.value)};var de=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};function Dt(t){return Object.prototype.toString.call(t)}var En=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"},pe=function(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n++)e(t[n],n,t)};pe(de(nt.prototype),function(t){xo[t]=function(e){var n=[].slice.call(arguments,1),o=new nt(e);return o[t].apply(o,n)}});var fe=Object.hasOwnProperty||function(t,e){return e in t},Mo=vn.exports,Lo=q;function q(t){if(!(this instanceof q))return new q(t);this._bbox=t||[1/0,1/0,-1/0,-1/0],this._valid=!!t}q.prototype.include=function(t){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[0]),this._bbox[3]=Math.max(this._bbox[3],t[1]),this},q.prototype.equals=function(t){var e;return e=t instanceof q?t.bbox():t,this._bbox[0]==e[0]&&this._bbox[1]==e[1]&&this._bbox[2]==e[2]&&this._bbox[3]==e[3]},q.prototype.center=function(t){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},q.prototype.union=function(t){var e;return this._valid=!0,e=t instanceof q?t.bbox():t,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[2]),this._bbox[3]=Math.max(this._bbox[3],e[3]),this},q.prototype.bbox=function(){return this._valid?this._bbox:null},q.prototype.contains=function(t){if(!t)return this._fastContains();if(!this._valid)return null;var e=t[0],n=t[1];return this._bbox[0]<=e&&this._bbox[1]<=n&&this._bbox[2]>=e&&this._bbox[3]>=n},q.prototype.intersect=function(t){return this._valid?(e=t instanceof q?t.bbox():t,!(this._bbox[0]>e[2]||this._bbox[2]<e[0]||this._bbox[3]<e[1]||this._bbox[1]>e[3])):null;var e},q.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var t="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",t)},q.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var No=function(t){if(!t)return[];var e=le(Oo(t)),n=[];return e.features.forEach(function(o){o.geometry&&(n=n.concat(Io(o.geometry.coordinates)))}),n},wo=Mo,Ao=Lo,Cn={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},Fo=Object.keys(Cn);function Ge(t){for(var e=Ao(),n=No(t),o=0;o<n.length;o++)e.include(n[o]);return e}ce.exports=function(t){return Ge(t).bbox()},ce.exports.polygon=function(t){return Ge(t).polygon()},ce.exports.bboxify=function(t){return wo(t).map(function(e){e&&Fo.some(function(n){return!!e[n]&&Cn[n].indexOf(e.type)!==-1})&&(e.bbox=Ge(e).bbox(),this.update(e))})};var Po=ct(ce.exports),he=-90;function Je(t,e){var n=he,o=90,r=he,i=90,a=270,l=-270;t.forEach(function(h){var g=Po(h),p=g[1],_=g[3],w=g[0],b=g[2];p>n&&(n=p),_<o&&(o=_),_>r&&(r=_),p<i&&(i=p),w<a&&(a=w),b>l&&(l=b)});var d=e;return n+d.lat>85&&(d.lat=85-n),r+d.lat>90&&(d.lat=90-r),o+d.lat<-85&&(d.lat=-85-o),i+d.lat<he&&(d.lat=he-i),a+d.lng<=-270&&(d.lng+=360*Math.ceil(Math.abs(d.lng)/360)),l+d.lng>=270&&(d.lng-=360*Math.ceil(Math.abs(d.lng)/360)),d}function ze(t,e){var n=Je(t.map(function(o){return o.toGeoJSON()}),e);t.forEach(function(o){var r,i=o.getCoordinates(),a=function(d){var h={lng:d[0]+n.lng,lat:d[1]+n.lat};return[h.lng,h.lat]},l=function(d){return d.map(function(h){return a(h)})};o.type===m.POINT?r=a(i):o.type===m.LINE_STRING||o.type===m.MULTI_POINT?r=i.map(a):o.type===m.POLYGON||o.type===m.MULTI_LINE_STRING?r=i.map(l):o.type===m.MULTI_POLYGON&&(r=i.map(function(d){return d.map(function(h){return l(h)})})),o.incomingCoords(r)})}var k={onSetup:function(t){var e=this,n={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:t.featureIds||[]};return this.setSelected(n.initiallySelectedFeatureIds.filter(function(o){return e.getFeature(o)!==void 0})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),n},fireUpdate:function(){this.map.fire(Y.UPDATE,{action:Jt.MOVE,features:this.getSelected().map(function(t){return t.toGeoJSON()})})},fireActionable:function(){var t=this,e=this.getSelected(),n=e.filter(function(l){return t.isInstanceOf("MultiFeature",l)}),o=!1;if(e.length>1){o=!0;var r=e[0].type.replace("Multi","");e.forEach(function(l){l.type.replace("Multi","")!==r&&(o=!1)})}var i=n.length>0,a=e.length>0;this.setActionableState({combineFeatures:o,uncombineFeatures:i,trash:a})},getUniqueIds:function(t){return t.length?t.map(function(e){return e.properties.id}).filter(function(e){return e!==void 0}).reduce(function(e,n){return e.add(n),e},new tt).values():[]},stopExtendedInteractions:function(t){t.boxSelectElement&&(t.boxSelectElement.parentNode&&t.boxSelectElement.parentNode.removeChild(t.boxSelectElement),t.boxSelectElement=null),this.map.dragPan.enable(),t.boxSelecting=!1,t.canBoxSelect=!1,t.dragMoving=!1,t.canDragMove=!1},onStop:function(){rt.enable(this)},onMouseMove:function(t,e){return Ve(e)&&t.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(t),!0},onMouseOut:function(t){return!t.dragMoving||this.fireUpdate()}};k.onTap=k.onClick=function(t,e){return re(e)?this.clickAnywhere(t,e):oe(V.VERTEX)(e)?this.clickOnVertex(t,e):Ve(e)?this.clickOnFeature(t,e):void 0},k.clickAnywhere=function(t){var e=this,n=this.getSelectedIds();n.length&&(this.clearSelectedFeatures(),n.forEach(function(o){return e.doRender(o)})),rt.enable(this),this.stopExtendedInteractions(t)},k.clickOnVertex=function(t,e){this.changeMode(C.DIRECT_SELECT,{featureId:e.featureTarget.properties.parent,coordPath:e.featureTarget.properties.coord_path,startPos:e.lngLat}),this.updateUIClasses({mouse:x.MOVE})},k.startOnActiveFeature=function(t,e){this.stopExtendedInteractions(t),this.map.dragPan.disable(),this.doRender(e.featureTarget.properties.id),t.canDragMove=!0,t.dragMoveLocation=e.lngLat},k.clickOnFeature=function(t,e){var n=this;rt.disable(this),this.stopExtendedInteractions(t);var o=ie(e),r=this.getSelectedIds(),i=e.featureTarget.properties.id,a=this.isSelected(i);if(!o&&a&&this.getFeature(i).type!==m.POINT)return this.changeMode(C.DIRECT_SELECT,{featureId:i});a&&o?(this.deselect(i),this.updateUIClasses({mouse:x.POINTER}),r.length===1&&rt.enable(this)):!a&&o?(this.select(i),this.updateUIClasses({mouse:x.MOVE})):a||o||(r.forEach(function(l){return n.doRender(l)}),this.setSelected(i),this.updateUIClasses({mouse:x.MOVE})),this.doRender(i)},k.onMouseDown=function(t,e){return Tt(e)?this.startOnActiveFeature(t,e):this.drawConfig.boxSelect&&gn(e)?this.startBoxSelect(t,e):void 0},k.startBoxSelect=function(t,e){this.stopExtendedInteractions(t),this.map.dragPan.disable(),t.boxSelectStartLocation=Be(e.originalEvent,this.map.getContainer()),t.canBoxSelect=!0},k.onTouchStart=function(t,e){if(Tt(e))return this.startOnActiveFeature(t,e)},k.onDrag=function(t,e){return t.canDragMove?this.dragMove(t,e):this.drawConfig.boxSelect&&t.canBoxSelect?this.whileBoxSelect(t,e):void 0},k.whileBoxSelect=function(t,e){t.boxSelecting=!0,this.updateUIClasses({mouse:x.ADD}),t.boxSelectElement||(t.boxSelectElement=document.createElement("div"),t.boxSelectElement.classList.add($.BOX_SELECT),this.map.getContainer().appendChild(t.boxSelectElement));var n=Be(e.originalEvent,this.map.getContainer()),o=Math.min(t.boxSelectStartLocation.x,n.x),r=Math.max(t.boxSelectStartLocation.x,n.x),i=Math.min(t.boxSelectStartLocation.y,n.y),a=Math.max(t.boxSelectStartLocation.y,n.y),l="translate("+o+"px, "+i+"px)";t.boxSelectElement.style.transform=l,t.boxSelectElement.style.WebkitTransform=l,t.boxSelectElement.style.width=r-o+"px",t.boxSelectElement.style.height=a-i+"px"},k.dragMove=function(t,e){t.dragMoving=!0,e.originalEvent.stopPropagation();var n={lng:e.lngLat.lng-t.dragMoveLocation.lng,lat:e.lngLat.lat-t.dragMoveLocation.lat};ze(this.getSelected(),n),t.dragMoveLocation=e.lngLat},k.onTouchEnd=k.onMouseUp=function(t,e){var n=this;if(t.dragMoving)this.fireUpdate();else if(t.boxSelecting){var o=[t.boxSelectStartLocation,Be(e.originalEvent,this.map.getContainer())],r=this.featuresAt(null,o,"click"),i=this.getUniqueIds(r).filter(function(a){return!n.isSelected(a)});i.length&&(this.select(i),i.forEach(function(a){return n.doRender(a)}),this.updateUIClasses({mouse:x.MOVE}))}this.stopExtendedInteractions(t)},k.toDisplayFeatures=function(t,e,n){e.properties.active=this.isSelected(e.properties.id)?B.ACTIVE:B.INACTIVE,n(e),this.fireActionable(),e.properties.active===B.ACTIVE&&e.geometry.type!==m.POINT&&ue(e).forEach(n)},k.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},k.onCombineFeatures=function(){var t=this.getSelected();if(!(t.length===0||t.length<2)){for(var e=[],n=[],o=t[0].type.replace("Multi",""),r=0;r<t.length;r++){var i=t[r];if(i.type.replace("Multi","")!==o)return;i.type.includes("Multi")?i.getCoordinates().forEach(function(l){e.push(l)}):e.push(i.getCoordinates()),n.push(i.toGeoJSON())}if(n.length>1){var a=this.newFeature({type:m.FEATURE,properties:n[0].properties,geometry:{type:"Multi"+o,coordinates:e}});this.addFeature(a),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([a.id]),this.map.fire(Y.COMBINE_FEATURES,{createdFeatures:[a.toGeoJSON()],deletedFeatures:n})}this.fireActionable()}},k.onUncombineFeatures=function(){var t=this,e=this.getSelected();if(e.length!==0){for(var n=[],o=[],r=function(a){var l=e[a];t.isInstanceOf("MultiFeature",l)&&(l.getFeatures().forEach(function(d){t.addFeature(d),d.properties=l.properties,n.push(d.toGeoJSON()),t.select([d.id])}),t.deleteFeature(l.id,{silent:!0}),o.push(l.toGeoJSON()))},i=0;i<e.length;i++)r(i);n.length>1&&this.map.fire(Y.UNCOMBINE_FEATURES,{createdFeatures:n,deletedFeatures:o}),this.fireActionable()}};var Tn=oe(V.VERTEX),Sn=oe(V.MIDPOINT),mt={fireUpdate:function(){this.map.fire(Y.UPDATE,{action:Jt.CHANGE_COORDINATES,features:this.getSelected().map(function(t){return t.toGeoJSON()})})},fireActionable:function(t){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:t.selectedCoordPaths.length>0})},startDragging:function(t,e){this.map.dragPan.disable(),t.canDragMove=!0,t.dragMoveLocation=e.lngLat},stopDragging:function(t){this.map.dragPan.enable(),t.dragMoving=!1,t.canDragMove=!1,t.dragMoveLocation=null},onVertex:function(t,e){this.startDragging(t,e);var n=e.featureTarget.properties,o=t.selectedCoordPaths.indexOf(n.coord_path);ie(e)||o!==-1?ie(e)&&o===-1&&t.selectedCoordPaths.push(n.coord_path):t.selectedCoordPaths=[n.coord_path];var r=this.pathsToCoordinates(t.featureId,t.selectedCoordPaths);this.setSelectedCoordinates(r)},onMidpoint:function(t,e){this.startDragging(t,e);var n=e.featureTarget.properties;t.feature.addCoordinate(n.coord_path,n.lng,n.lat),this.fireUpdate(),t.selectedCoordPaths=[n.coord_path]},pathsToCoordinates:function(t,e){return e.map(function(n){return{feature_id:t,coord_path:n}})},onFeature:function(t,e){t.selectedCoordPaths.length===0?this.startDragging(t,e):this.stopDragging(t)},dragFeature:function(t,e,n){ze(this.getSelected(),n),t.dragMoveLocation=e.lngLat},dragVertex:function(t,e,n){for(var o=t.selectedCoordPaths.map(function(l){return t.feature.getCoordinate(l)}),r=Je(o.map(function(l){return{type:m.FEATURE,properties:{},geometry:{type:m.POINT,coordinates:l}}}),n),i=0;i<o.length;i++){var a=o[i];t.feature.updateCoordinate(t.selectedCoordPaths[i],a[0]+r.lng,a[1]+r.lat)}},clickNoTarget:function(){this.changeMode(C.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(C.SIMPLE_SELECT)},clickActiveFeature:function(t){t.selectedCoordPaths=[],this.clearSelectedCoordinates(),t.feature.changed()},onSetup:function(t){var e=t.featureId,n=this.getFeature(e);if(!n)throw new Error("You must provide a featureId to enter direct_select mode");if(n.type===m.POINT)throw new TypeError("direct_select mode doesn't handle point features");var o={featureId:e,feature:n,dragMoveLocation:t.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:t.coordPath?[t.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(e,o.selectedCoordPaths)),this.setSelected(e),rt.disable(this),this.setActionableState({trash:!0}),o},onStop:function(){rt.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(t,e,n){t.featureId===e.properties.id?(e.properties.active=B.ACTIVE,n(e),ue(e,{map:this.map,midpoints:!0,selectedPaths:t.selectedCoordPaths}).forEach(n)):(e.properties.active=B.INACTIVE,n(e)),this.fireActionable(t)},onTrash:function(t){t.selectedCoordPaths.sort(function(e,n){return n.localeCompare(e,"en",{numeric:!0})}).forEach(function(e){return t.feature.removeCoordinate(e)}),this.fireUpdate(),t.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(t),t.feature.isValid()===!1&&(this.deleteFeature([t.featureId]),this.changeMode(C.SIMPLE_SELECT,{}))},onMouseMove:function(t,e){var n=Tt(e),o=Tn(e),r=Sn(e),i=t.selectedCoordPaths.length===0;return n&&i||o&&!i?this.updateUIClasses({mouse:x.MOVE}):this.updateUIClasses({mouse:x.NONE}),(o||n||r)&&t.dragMoving&&this.fireUpdate(),this.stopDragging(t),!0},onMouseOut:function(t){return t.dragMoving&&this.fireUpdate(),!0}};mt.onTouchStart=mt.onMouseDown=function(t,e){return Tn(e)?this.onVertex(t,e):Tt(e)?this.onFeature(t,e):Sn(e)?this.onMidpoint(t,e):void 0},mt.onDrag=function(t,e){if(t.canDragMove===!0){t.dragMoving=!0,e.originalEvent.stopPropagation();var n={lng:e.lngLat.lng-t.dragMoveLocation.lng,lat:e.lngLat.lat-t.dragMoveLocation.lat};t.selectedCoordPaths.length>0?this.dragVertex(t,e,n):this.dragFeature(t,e,n),t.dragMoveLocation=e.lngLat}},mt.onClick=function(t,e){return re(e)?this.clickNoTarget(t,e):Tt(e)?this.clickActiveFeature(t,e):je(e)?this.clickInactive(t,e):void this.stopDragging(t)},mt.onTap=function(t,e){return re(e)?this.clickNoTarget(t,e):Tt(e)?this.clickActiveFeature(t,e):je(e)?this.clickInactive(t,e):void 0},mt.onTouchEnd=mt.onMouseUp=function(t){t.dragMoving&&this.fireUpdate(),this.stopDragging(t)};var at={};function ge(t,e){return!!t.lngLat&&t.lngLat.lng===e[0]&&t.lngLat.lat===e[1]}at.onSetup=function(){var t=this.newFeature({type:m.FEATURE,properties:{},geometry:{type:m.POINT,coordinates:[]}});return this.addFeature(t),this.clearSelectedFeatures(),this.updateUIClasses({mouse:x.ADD}),this.activateUIButton(J.POINT),this.setActionableState({trash:!0}),{point:t}},at.stopDrawingAndRemove=function(t){this.deleteFeature([t.point.id],{silent:!0}),this.changeMode(C.SIMPLE_SELECT)},at.onTap=at.onClick=function(t,e){this.updateUIClasses({mouse:x.MOVE}),t.point.updateCoordinate("",e.lngLat.lng,e.lngLat.lat),this.map.fire(Y.CREATE,{features:[t.point.toGeoJSON()]}),this.changeMode(C.SIMPLE_SELECT,{featureIds:[t.point.id]})},at.onStop=function(t){this.activateUIButton(),t.point.getCoordinate().length||this.deleteFeature([t.point.id],{silent:!0})},at.toDisplayFeatures=function(t,e,n){var o=e.properties.id===t.point.id;if(e.properties.active=o?B.ACTIVE:B.INACTIVE,!o)return n(e)},at.onTrash=at.stopDrawingAndRemove,at.onKeyUp=function(t,e){if(ae(e)||se(e))return this.stopDrawingAndRemove(t,e)};var St={onSetup:function(){var t=this.newFeature({type:m.FEATURE,properties:{},geometry:{type:m.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),rt.disable(this),this.updateUIClasses({mouse:x.ADD}),this.activateUIButton(J.POLYGON),this.setActionableState({trash:!0}),{polygon:t,currentVertexPosition:0}},clickAnywhere:function(t,e){if(t.currentVertexPosition>0&&ge(e,t.polygon.coordinates[0][t.currentVertexPosition-1]))return this.changeMode(C.SIMPLE_SELECT,{featureIds:[t.polygon.id]});this.updateUIClasses({mouse:x.ADD}),t.polygon.updateCoordinate("0."+t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),t.currentVertexPosition++,t.polygon.updateCoordinate("0."+t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat)},clickOnVertex:function(t){return this.changeMode(C.SIMPLE_SELECT,{featureIds:[t.polygon.id]})},onMouseMove:function(t,e){t.polygon.updateCoordinate("0."+t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),$t(e)&&this.updateUIClasses({mouse:x.POINTER})}};St.onTap=St.onClick=function(t,e){return $t(e)?this.clickOnVertex(t,e):this.clickAnywhere(t,e)},St.onKeyUp=function(t,e){ae(e)?(this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode(C.SIMPLE_SELECT)):se(e)&&this.changeMode(C.SIMPLE_SELECT,{featureIds:[t.polygon.id]})},St.onStop=function(t){this.updateUIClasses({mouse:x.NONE}),rt.enable(this),this.activateUIButton(),this.getFeature(t.polygon.id)!==void 0&&(t.polygon.removeCoordinate("0."+t.currentVertexPosition),t.polygon.isValid()?this.map.fire(Y.CREATE,{features:[t.polygon.toGeoJSON()]}):(this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode(C.SIMPLE_SELECT,{},{silent:!0})))},St.toDisplayFeatures=function(t,e,n){var o=e.properties.id===t.polygon.id;if(e.properties.active=o?B.ACTIVE:B.INACTIVE,!o)return n(e);if(e.geometry.coordinates.length!==0){var r=e.geometry.coordinates[0].length;if(!(r<3)){if(e.properties.meta=V.FEATURE,n(Rt(t.polygon.id,e.geometry.coordinates[0][0],"0.0",!1)),r>3){var i=e.geometry.coordinates[0].length-3;n(Rt(t.polygon.id,e.geometry.coordinates[0][i],"0."+i,!1))}if(r<=4){var a=[[e.geometry.coordinates[0][0][0],e.geometry.coordinates[0][0][1]],[e.geometry.coordinates[0][1][0],e.geometry.coordinates[0][1][1]]];if(n({type:m.FEATURE,properties:e.properties,geometry:{coordinates:a,type:m.LINE_STRING}}),r===3)return}return n(e)}}},St.onTrash=function(t){this.deleteFeature([t.polygon.id],{silent:!0}),this.changeMode(C.SIMPLE_SELECT)};var Ot={onSetup:function(t){var e,n,o=(t=t||{}).featureId,r="forward";if(o){if(!(e=this.getFeature(o)))throw new Error("Could not find a feature with the provided featureId");var i=t.from;if(i&&i.type==="Feature"&&i.geometry&&i.geometry.type==="Point"&&(i=i.geometry),i&&i.type==="Point"&&i.coordinates&&i.coordinates.length===2&&(i=i.coordinates),!i||!Array.isArray(i))throw new Error("Please use the `from` property to indicate which point to continue the line from");var a=e.coordinates.length-1;if(e.coordinates[a][0]===i[0]&&e.coordinates[a][1]===i[1])n=a+1,e.addCoordinate.apply(e,[n].concat(e.coordinates[a]));else{if(e.coordinates[0][0]!==i[0]||e.coordinates[0][1]!==i[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");r="backwards",n=0,e.addCoordinate.apply(e,[n].concat(e.coordinates[0]))}}else e=this.newFeature({type:m.FEATURE,properties:{},geometry:{type:m.LINE_STRING,coordinates:[]}}),n=0,this.addFeature(e);return this.clearSelectedFeatures(),rt.disable(this),this.updateUIClasses({mouse:x.ADD}),this.activateUIButton(J.LINE),this.setActionableState({trash:!0}),{line:e,currentVertexPosition:n,direction:r}},clickAnywhere:function(t,e){if(t.currentVertexPosition>0&&ge(e,t.line.coordinates[t.currentVertexPosition-1])||t.direction==="backwards"&&ge(e,t.line.coordinates[t.currentVertexPosition+1]))return this.changeMode(C.SIMPLE_SELECT,{featureIds:[t.line.id]});this.updateUIClasses({mouse:x.ADD}),t.line.updateCoordinate(t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),t.direction==="forward"?(t.currentVertexPosition++,t.line.updateCoordinate(t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat)):t.line.addCoordinate(0,e.lngLat.lng,e.lngLat.lat)},clickOnVertex:function(t){return this.changeMode(C.SIMPLE_SELECT,{featureIds:[t.line.id]})},onMouseMove:function(t,e){t.line.updateCoordinate(t.currentVertexPosition,e.lngLat.lng,e.lngLat.lat),$t(e)&&this.updateUIClasses({mouse:x.POINTER})}};Ot.onTap=Ot.onClick=function(t,e){if($t(e))return this.clickOnVertex(t,e);this.clickAnywhere(t,e)},Ot.onKeyUp=function(t,e){se(e)?this.changeMode(C.SIMPLE_SELECT,{featureIds:[t.line.id]}):ae(e)&&(this.deleteFeature([t.line.id],{silent:!0}),this.changeMode(C.SIMPLE_SELECT))},Ot.onStop=function(t){rt.enable(this),this.activateUIButton(),this.getFeature(t.line.id)!==void 0&&(t.line.removeCoordinate(""+t.currentVertexPosition),t.line.isValid()?this.map.fire(Y.CREATE,{features:[t.line.toGeoJSON()]}):(this.deleteFeature([t.line.id],{silent:!0}),this.changeMode(C.SIMPLE_SELECT,{},{silent:!0})))},Ot.onTrash=function(t){this.deleteFeature([t.line.id],{silent:!0}),this.changeMode(C.SIMPLE_SELECT)},Ot.toDisplayFeatures=function(t,e,n){var o=e.properties.id===t.line.id;if(e.properties.active=o?B.ACTIVE:B.INACTIVE,!o)return n(e);e.geometry.coordinates.length<2||(e.properties.meta=V.FEATURE,n(Rt(t.line.id,e.geometry.coordinates[t.direction==="forward"?e.geometry.coordinates.length-2:1],""+(t.direction==="forward"?e.geometry.coordinates.length-2:1),!1)),n(e))};var On={simple_select:k,direct_select:mt,draw_point:at,draw_polygon:St,draw_line_string:Ot},Ro={defaultMode:C.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:hn,modes:On,controls:{},userProperties:!1},Do={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},ko={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function In(t,e){return t.map(function(n){return n.source?n:yt(n,{id:n.id+"."+e,source:e==="hot"?Z.HOT:Z.COLD})})}var $e={exports:{}};(function(t,e){var n="__lodash_hash_undefined__",o=9007199254740991,r="[object Arguments]",i="[object Array]",a="[object Boolean]",l="[object Date]",d="[object Error]",h="[object Function]",g="[object Map]",p="[object Number]",_="[object Object]",w="[object Promise]",b="[object RegExp]",P="[object Set]",c="[object String]",y="[object Symbol]",S="[object WeakMap]",G="[object ArrayBuffer]",R="[object DataView]",Ye=/^\[object .+?Constructor\]$/,Bo=/^(?:0|[1-9]\d*)$/,L={};L["[object Float32Array]"]=L["[object Float64Array]"]=L["[object Int8Array]"]=L["[object Int16Array]"]=L["[object Int32Array]"]=L["[object Uint8Array]"]=L["[object Uint8ClampedArray]"]=L["[object Uint16Array]"]=L["[object Uint32Array]"]=!0,L[r]=L[i]=L[G]=L[a]=L[R]=L[l]=L[d]=L[h]=L[g]=L[p]=L[_]=L[b]=L[P]=L[c]=L[S]=!1;var Ln=typeof Kt=="object"&&Kt&&Kt.Object===Object&&Kt,Go=typeof self=="object"&&self&&self.Object===Object&&self,dt=Ln||Go||Function("return this")(),Nn=e&&!e.nodeType&&e,wn=Nn&&t&&!t.nodeType&&t,An=wn&&wn.exports===Nn,Xe=An&&Ln.process,Fn=function(){try{return Xe&&Xe.binding&&Xe.binding("util")}catch{}}(),Pn=Fn&&Fn.isTypedArray;function Jo(s,u){for(var f=-1,v=s==null?0:s.length;++f<v;)if(u(s[f],f,s))return!0;return!1}function zo(s){var u=-1,f=Array(s.size);return s.forEach(function(v,N){f[++u]=[N,v]}),f}function $o(s){var u=-1,f=Array(s.size);return s.forEach(function(v){f[++u]=v}),f}var Rn,Dn,kn,Yo=Array.prototype,Xo=Function.prototype,me=Object.prototype,qe=dt["__core-js_shared__"],Un=Xo.toString,st=me.hasOwnProperty,jn=(Rn=/[^.]+$/.exec(qe&&qe.keys&&qe.keys.IE_PROTO||""))?"Symbol(src)_1."+Rn:"",Vn=me.toString,qo=RegExp("^"+Un.call(st).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bn=An?dt.Buffer:void 0,ve=dt.Symbol,Gn=dt.Uint8Array,Jn=me.propertyIsEnumerable,Ho=Yo.splice,It=ve?ve.toStringTag:void 0,zn=Object.getOwnPropertySymbols,Zo=Bn?Bn.isBuffer:void 0,Wo=(Dn=Object.keys,kn=Object,function(s){return Dn(kn(s))}),He=kt(dt,"DataView"),Yt=kt(dt,"Map"),Ze=kt(dt,"Promise"),We=kt(dt,"Set"),Ke=kt(dt,"WeakMap"),Xt=kt(Object,"create"),Ko=Lt(He),Qo=Lt(Yt),tr=Lt(Ze),er=Lt(We),nr=Lt(Ke),$n=ve?ve.prototype:void 0,Qe=$n?$n.valueOf:void 0;function xt(s){var u=-1,f=s==null?0:s.length;for(this.clear();++u<f;){var v=s[u];this.set(v[0],v[1])}}function pt(s){var u=-1,f=s==null?0:s.length;for(this.clear();++u<f;){var v=s[u];this.set(v[0],v[1])}}function Mt(s){var u=-1,f=s==null?0:s.length;for(this.clear();++u<f;){var v=s[u];this.set(v[0],v[1])}}function _e(s){var u=-1,f=s==null?0:s.length;for(this.__data__=new Mt;++u<f;)this.add(s[u])}function vt(s){var u=this.__data__=new pt(s);this.size=u.size}function or(s,u){var f=Ce(s),v=!f&&ur(s),N=!f&&!v&&tn(s),T=!f&&!v&&!N&&to(s),A=f||v||N||T,D=A?function(j,ut){for(var ft=-1,H=Array(j);++ft<j;)H[ft]=ut(ft);return H}(s.length,String):[],it=D.length;for(var U in s)!u&&!st.call(s,U)||A&&(U=="length"||N&&(U=="offset"||U=="parent")||T&&(U=="buffer"||U=="byteLength"||U=="byteOffset")||sr(U,it))||D.push(U);return D}function be(s,u){for(var f=s.length;f--;)if(Zn(s[f][0],u))return f;return-1}function qt(s){return s==null?s===void 0?"[object Undefined]":"[object Null]":It&&It in Object(s)?function(u){var f=st.call(u,It),v=u[It];try{u[It]=void 0;var N=!0}catch{}var T=Vn.call(u);return N&&(f?u[It]=v:delete u[It]),T}(s):function(u){return Vn.call(u)}(s)}function Yn(s){return Ht(s)&&qt(s)==r}function Xn(s,u,f,v,N){return s===u||(s==null||u==null||!Ht(s)&&!Ht(u)?s!=s&&u!=u:function(T,A,D,it,U,j){var ut=Ce(T),ft=Ce(A),H=ut?i:_t(T),ht=ft?i:_t(A),Ut=(H=H==r?_:H)==_,Te=(ht=ht==r?_:ht)==_,jt=H==ht;if(jt&&tn(T)){if(!tn(A))return!1;ut=!0,Ut=!1}if(jt&&!Ut)return j||(j=new vt),ut||to(T)?qn(T,A,D,it,U,j):function(I,O,Se,bt,en,ot,gt){switch(Se){case R:if(I.byteLength!=O.byteLength||I.byteOffset!=O.byteOffset)return!1;I=I.buffer,O=O.buffer;case G:return!(I.byteLength!=O.byteLength||!ot(new Gn(I),new Gn(O)));case a:case l:case p:return Zn(+I,+O);case d:return I.name==O.name&&I.message==O.message;case b:case c:return I==O+"";case g:var Et=zo;case P:var Wt=1&bt;if(Et||(Et=$o),I.size!=O.size&&!Wt)return!1;var Oe=gt.get(I);if(Oe)return Oe==O;bt|=2,gt.set(I,O);var Vt=qn(Et(I),Et(O),bt,en,ot,gt);return gt.delete(I),Vt;case y:if(Qe)return Qe.call(I)==Qe.call(O)}return!1}(T,A,H,D,it,U,j);if(!(1&D)){var Zt=Ut&&st.call(T,"__wrapped__"),eo=Te&&st.call(A,"__wrapped__");if(Zt||eo){var lr=Zt?T.value():T,dr=eo?A.value():A;return j||(j=new vt),U(lr,dr,D,it,j)}}return jt?(j||(j=new vt),function(I,O,Se,bt,en,ot){var gt=1&Se,Et=Hn(I),Wt=Et.length,Oe=Hn(O).length;if(Wt!=Oe&&!gt)return!1;for(var Vt=Wt;Vt--;){var Nt=Et[Vt];if(!(gt?Nt in O:st.call(O,Nt)))return!1}var no=ot.get(I);if(no&&ot.get(O))return no==O;var Ie=!0;ot.set(I,O),ot.set(O,I);for(var nn=gt;++Vt<Wt;){var xe=I[Nt=Et[Vt]],Me=O[Nt];if(bt)var oo=gt?bt(Me,xe,Nt,O,I,ot):bt(xe,Me,Nt,I,O,ot);if(!(oo===void 0?xe===Me||en(xe,Me,Se,bt,ot):oo)){Ie=!1;break}nn||(nn=Nt=="constructor")}if(Ie&&!nn){var Le=I.constructor,Ne=O.constructor;Le==Ne||!("constructor"in I)||!("constructor"in O)||typeof Le=="function"&&Le instanceof Le&&typeof Ne=="function"&&Ne instanceof Ne||(Ie=!1)}return ot.delete(I),ot.delete(O),Ie}(T,A,D,it,U,j)):!1}(s,u,f,v,Xn,N))}function rr(s){return!(!Qn(s)||function(u){return!!jn&&jn in u}(s))&&(Wn(s)?qo:Ye).test(Lt(s))}function ir(s){if(f=(u=s)&&u.constructor,v=typeof f=="function"&&f.prototype||me,u!==v)return Wo(s);var u,f,v,N=[];for(var T in Object(s))st.call(s,T)&&T!="constructor"&&N.push(T);return N}function qn(s,u,f,v,N,T){var A=1&f,D=s.length,it=u.length;if(D!=it&&!(A&&it>D))return!1;var U=T.get(s);if(U&&T.get(u))return U==u;var j=-1,ut=!0,ft=2&f?new _e:void 0;for(T.set(s,u),T.set(u,s);++j<D;){var H=s[j],ht=u[j];if(v)var Ut=A?v(ht,H,j,u,s,T):v(H,ht,j,s,u,T);if(Ut!==void 0){if(Ut)continue;ut=!1;break}if(ft){if(!Jo(u,function(Te,jt){if(Zt=jt,!ft.has(Zt)&&(H===Te||N(H,Te,f,v,T)))return ft.push(jt);var Zt})){ut=!1;break}}else if(H!==ht&&!N(H,ht,f,v,T)){ut=!1;break}}return T.delete(s),T.delete(u),ut}function Hn(s){return function(u,f,v){var N=f(u);return Ce(u)?N:function(T,A){for(var D=-1,it=A.length,U=T.length;++D<it;)T[U+D]=A[D];return T}(N,v(u))}(s,cr,ar)}function Ee(s,u){var f,v,N=s.__data__;return((v=typeof(f=u))=="string"||v=="number"||v=="symbol"||v=="boolean"?f!=="__proto__":f===null)?N[typeof u=="string"?"string":"hash"]:N.map}function kt(s,u){var f=function(v,N){return v==null?void 0:v[N]}(s,u);return rr(f)?f:void 0}xt.prototype.clear=function(){this.__data__=Xt?Xt(null):{},this.size=0},xt.prototype.delete=function(s){var u=this.has(s)&&delete this.__data__[s];return this.size-=u?1:0,u},xt.prototype.get=function(s){var u=this.__data__;if(Xt){var f=u[s];return f===n?void 0:f}return st.call(u,s)?u[s]:void 0},xt.prototype.has=function(s){var u=this.__data__;return Xt?u[s]!==void 0:st.call(u,s)},xt.prototype.set=function(s,u){var f=this.__data__;return this.size+=this.has(s)?0:1,f[s]=Xt&&u===void 0?n:u,this},pt.prototype.clear=function(){this.__data__=[],this.size=0},pt.prototype.delete=function(s){var u=this.__data__,f=be(u,s);return!(f<0)&&(f==u.length-1?u.pop():Ho.call(u,f,1),--this.size,!0)},pt.prototype.get=function(s){var u=this.__data__,f=be(u,s);return f<0?void 0:u[f][1]},pt.prototype.has=function(s){return be(this.__data__,s)>-1},pt.prototype.set=function(s,u){var f=this.__data__,v=be(f,s);return v<0?(++this.size,f.push([s,u])):f[v][1]=u,this},Mt.prototype.clear=function(){this.size=0,this.__data__={hash:new xt,map:new(Yt||pt),string:new xt}},Mt.prototype.delete=function(s){var u=Ee(this,s).delete(s);return this.size-=u?1:0,u},Mt.prototype.get=function(s){return Ee(this,s).get(s)},Mt.prototype.has=function(s){return Ee(this,s).has(s)},Mt.prototype.set=function(s,u){var f=Ee(this,s),v=f.size;return f.set(s,u),this.size+=f.size==v?0:1,this},_e.prototype.add=_e.prototype.push=function(s){return this.__data__.set(s,n),this},_e.prototype.has=function(s){return this.__data__.has(s)},vt.prototype.clear=function(){this.__data__=new pt,this.size=0},vt.prototype.delete=function(s){var u=this.__data__,f=u.delete(s);return this.size=u.size,f},vt.prototype.get=function(s){return this.__data__.get(s)},vt.prototype.has=function(s){return this.__data__.has(s)},vt.prototype.set=function(s,u){var f=this.__data__;if(f instanceof pt){var v=f.__data__;if(!Yt||v.length<199)return v.push([s,u]),this.size=++f.size,this;f=this.__data__=new Mt(v)}return f.set(s,u),this.size=f.size,this};var ar=zn?function(s){return s==null?[]:(s=Object(s),function(u,f){for(var v=-1,N=u==null?0:u.length,T=0,A=[];++v<N;){var D=u[v];f(D,v,u)&&(A[T++]=D)}return A}(zn(s),function(u){return Jn.call(s,u)}))}:function(){return[]},_t=qt;function sr(s,u){return!!(u=u??o)&&(typeof s=="number"||Bo.test(s))&&s>-1&&s%1==0&&s<u}function Lt(s){if(s!=null){try{return Un.call(s)}catch{}try{return s+""}catch{}}return""}function Zn(s,u){return s===u||s!=s&&u!=u}(He&&_t(new He(new ArrayBuffer(1)))!=R||Yt&&_t(new Yt)!=g||Ze&&_t(Ze.resolve())!=w||We&&_t(new We)!=P||Ke&&_t(new Ke)!=S)&&(_t=function(s){var u=qt(s),f=u==_?s.constructor:void 0,v=f?Lt(f):"";if(v)switch(v){case Ko:return R;case Qo:return g;case tr:return w;case er:return P;case nr:return S}return u});var ur=Yn(function(){return arguments}())?Yn:function(s){return Ht(s)&&st.call(s,"callee")&&!Jn.call(s,"callee")},Ce=Array.isArray,tn=Zo||function(){return!1};function Wn(s){if(!Qn(s))return!1;var u=qt(s);return u==h||u=="[object GeneratorFunction]"||u=="[object AsyncFunction]"||u=="[object Proxy]"}function Kn(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=o}function Qn(s){var u=typeof s;return s!=null&&(u=="object"||u=="function")}function Ht(s){return s!=null&&typeof s=="object"}var to=Pn?function(s){return function(u){return s(u)}}(Pn):function(s){return Ht(s)&&Kn(s.length)&&!!L[qt(s)]};function cr(s){return(u=s)!=null&&Kn(u.length)&&!Wn(u)?or(s):ir(s);var u}t.exports=function(s,u){return Xn(s,u)}})($e,$e.exports);var xn=ct($e.exports);function Mn(t,e){return t.length===e.length&&JSON.stringify(t.map(function(n){return n}).sort())===JSON.stringify(e.map(function(n){return n}).sort())}var Uo={Polygon:et,LineString:lt,Point:Ct,MultiPolygon:W,MultiLineString:W,MultiPoint:W},jo=Object.freeze({__proto__:null,CommonSelectors:_o,constrainFeatureMovement:Je,createMidPoint:yn,createSupplementaryPoints:ue,createVertex:Rt,doubleClickZoom:rt,euclideanDistance:Pe,featuresAt:Ft,getFeatureAtAndSetCursors:ee,isClick:Re,isEventAtCoordinates:ge,isTap:De,mapEventToBoundingBox:cn,ModeHandler:wt,moveFeatures:ze,sortFeatures:un,stringSetsAreEqual:Mn,StringSet:tt,theme:hn,toDenseArray:zt}),Vo=function(t,e){var n={options:t=function(r){r===void 0&&(r={});var i=yt(r);return r.controls||(i.controls={}),r.displayControlsDefault===!1?i.controls=yt(ko,r.controls):i.controls=yt(Do,r.controls),(i=yt(Ro,i)).styles=In(i.styles,"cold").concat(In(i.styles,"hot")),i}(t)};e=function(r,i){return i.modes=C,i.getFeatureIdsAt=function(a){return Ft.click({point:a},null,r).map(function(l){return l.properties.id})},i.getSelectedIds=function(){return r.store.getSelectedIds()},i.getSelected=function(){return{type:m.FEATURE_COLLECTION,features:r.store.getSelectedIds().map(function(a){return r.store.get(a)}).map(function(a){return a.toGeoJSON()})}},i.getSelectedPoints=function(){return{type:m.FEATURE_COLLECTION,features:r.store.getSelectedCoordinates().map(function(a){return{type:m.FEATURE,properties:{},geometry:{type:m.POINT,coordinates:a.coordinates}}})}},i.set=function(a){if(a.type===void 0||a.type!==m.FEATURE_COLLECTION||!Array.isArray(a.features))throw new Error("Invalid FeatureCollection");var l=r.store.createRenderBatch(),d=r.store.getAllIds().slice(),h=i.add(a),g=new tt(h);return(d=d.filter(function(p){return!g.has(p)})).length&&i.delete(d),l(),h},i.add=function(a){var l=JSON.parse(JSON.stringify(To(a))).features.map(function(d){if(d.id=d.id||Ue(),d.geometry===null)throw new Error("Invalid geometry: null");if(r.store.get(d.id)===void 0||r.store.get(d.id).type!==d.geometry.type){var h=Uo[d.geometry.type];if(h===void 0)throw new Error("Invalid geometry type: "+d.geometry.type+".");var g=new h(r,d);r.store.add(g)}else{var p=r.store.get(d.id);p.properties=d.properties,xn(p.properties,d.properties)||r.store.featureChanged(p.id),xn(p.getCoordinates(),d.geometry.coordinates)||p.incomingCoords(d.geometry.coordinates)}return d.id});return r.store.render(),l},i.get=function(a){var l=r.store.get(a);if(l)return l.toGeoJSON()},i.getAll=function(){return{type:m.FEATURE_COLLECTION,features:r.store.getAll().map(function(a){return a.toGeoJSON()})}},i.delete=function(a){return r.store.delete(a,{silent:!0}),i.getMode()!==C.DIRECT_SELECT||r.store.getSelectedIds().length?r.store.render():r.events.changeMode(C.SIMPLE_SELECT,void 0,{silent:!0}),i},i.deleteAll=function(){return r.store.delete(r.store.getAllIds(),{silent:!0}),i.getMode()===C.DIRECT_SELECT?r.events.changeMode(C.SIMPLE_SELECT,void 0,{silent:!0}):r.store.render(),i},i.changeMode=function(a,l){return l===void 0&&(l={}),a===C.SIMPLE_SELECT&&i.getMode()===C.SIMPLE_SELECT?(Mn(l.featureIds||[],r.store.getSelectedIds())||(r.store.setSelected(l.featureIds,{silent:!0}),r.store.render()),i):(a===C.DIRECT_SELECT&&i.getMode()===C.DIRECT_SELECT&&l.featureId===r.store.getSelectedIds()[0]||r.events.changeMode(a,l,{silent:!0}),i)},i.getMode=function(){return r.events.getMode()},i.trash=function(){return r.events.trash({silent:!0}),i},i.combineFeatures=function(){return r.events.combineFeatures({silent:!0}),i},i.uncombineFeatures=function(){return r.events.uncombineFeatures({silent:!0}),i},i.setFeatureProperty=function(a,l,d){return r.store.setFeatureProperty(a,l,d),i},i}(n,e),n.api=e;var o=vo(n);return e.onAdd=o.onAdd,e.onRemove=o.onRemove,e.types=J,e.options=t,e};function ye(t){Vo(t,this)}return ye.modes=On,ye.constants=so,ye.lib=jo,ye})})(ao);var _r=ao.exports;const br=fr(_r);const Er={name:"MapboxGeofence",components:{myForm:pr,MainLayout:mr},props:{form_data:Object,modelRoute:String,title:String},data(){return{map:null,draw:null,geofenceData:[],drivers:[],driver_group:[],form:{}}},mounted(){ro.accessToken="pk.eyJ1IjoiamltbGFyYXZlbCIsImEiOiJjbDdydXA5djkwaXR2M3FwMmxwc2h3YjdqIn0.rgDAW_8AKT6dHtGHXX1DtQ",this.initializeMap(),this.getDrivers(),this.getDriverGroup()},methods:{getDrivers(){on.get("/driver-data").then(F=>{this.drivers=F.data,console.log(" ~ axios.get ~ res:",F)}).catch(F=>{console.log(" ~ axios.get ~ error:",F)})},getDriverGroup(){on.get("/driver-group").then(F=>{this.driver_group=F.data,console.log(" ~ axios.get ~ res:",F)}).catch(F=>{console.log(" ~ axios.get ~ error:",F)})},initializeMap(){this.map=new ro.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[36.828167203867835,-1.2918808498502665],zoom:8}),this.draw=new br({}),this.map.addControl(this.draw),this.map.on("draw.create",async F=>{const we=F.features[0];this.geofenceData=we})},async sendGeofenceData(){try{this.form.form_data=this.form_data,this.form.coordinates=this.geofenceData;const F=await on.post("geofences",this.form);console.log("Geofence data sent:",F.data)}catch(F){console.error("Error sending geofence data:",F)}},addCityBoundaries(){const F={type:"FeatureCollection",features:[]};this.map.addSource("city-boundaries",{type:"geojson",data:F}),this.map.addLayer({id:"city-boundaries-layer",type:"fill",source:"city-boundaries",paint:{"fill-color":"blue","fill-opacity":.5}})}}},Cr=yr("div",{id:"map"},null,-1);function Tr(F,we,wt,ct,rn,Bt){const Ae=K("v-card-title"),Qt=K("v-divider"),te=K("myForm"),At=K("v-card-text"),Gt=K("v-spacer"),$=K("v-btn"),Z=K("v-card-actions"),x=K("v-card"),J=K("v-col"),m=K("v-row"),C=K("v-container"),Y=K("v-main"),Jt=K("v-app"),V=K("MainLayout");return hr(),gr(V,{title:"Sale Management",rail:!0},{default:Q(()=>[z(Jt,null,{default:Q(()=>[z(Y,null,{default:Q(()=>[z(C,{fluid:""},{default:Q(()=>[z(m,null,{default:Q(()=>[z(J,{cols:"3"},{default:Q(()=>[z(x,null,{default:Q(()=>[z(Ae,{"primary-title":""},{default:Q(()=>[io(" Maps ")]),_:1}),z(Qt),z(At,null,{default:Q(()=>[z(te,{form_data:wt.form_data},null,8,["form_data"])]),_:1}),z(Z,null,{default:Q(()=>[z(Gt),z($,{"prepend-icon":"mdi-send",variant:"tonal",color:"info",onClick:Bt.sendGeofenceData},{default:Q(()=>[io(" Submit ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),z(J,{col:"9"},{default:Q(()=>[z(x,null,{default:Q(()=>[z(At,null,{default:Q(()=>[Cr]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const wr=vr(Er,[["render",Tr]]);export{wr as default};
